
#CONFIG OPTIONS
#https://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/api-reference/kconfig.html#sdk-tool-configuration

CONFIG_FLASHMODE_QIO=y
CONFIG_ESPTOOLPY_FLASHFREQ_80M=y
CONFIG_ESPTOOLPY_FLASHSIZE_DETECT=y
CONFIG_ESPTOOLPY_AFTER_NORESET=y
CONFIG_SPIRAM_MEMTEST=
CONFIG_SPIRAM_MODE_QUAD=
CONFIG_SPIRAM_MODE_OCT=y
CONFIG_SPIRAM_SPEED_80M=
CONFIG_SPIRAM_SPEED_120M=y
CONFIG_SPIRAM_FETCH_INSTRUCTIONS=y # load/exectue from PSRAM instead of flash
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=
CONFIG_ESPTOOLPY_FLASHSIZE_8MB=
CONFIG_ESPTOOLPY_FLASHSIZE_16MB=y

#Enable dynamic frequency scaling (DFS) at startup
#https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/api-reference/kconfig.html?highlight=config_pm_dfs_init_auto
CONFIG_PM_DFS_INIT_AUTO=y
CONFIG_FREERTOS_USE_TICKLESS_IDLE=y
CONFIG_FREERTOS_IDLE_TIME_BEFORE_SLEEP=100

#set freq to 240Mhz
CONFIG_ESP32S3_DEFAULT_CPU_FREQ_MHZ=240


#COMPILER OPTIMIZATIONS
#CONFIG_COMPILER_OPTIMIZATION_SIZE=
CONFIG_COMPILER_OPTIMIZATION_PERF=y

#OTA
CONFIG_BOOTLOADER_APP_ROLLBACK_ENABLE=y
CONFIG_PARTITION_TABLE_CUSTOM=y
CONFIG_PARTITION_TABLE_CUSTOM_FILENAME="partitions-titan-N16+store.csv"


#investigate disabling second core to save power
#CONFIG_FREERTOS_UNICORE=y

CONFIG_LWIP_LOCAL_HOSTNAME="TITAN"

#RTC
#https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/kconfig.html#config-rtc-clk-src
CONFIG_ESP32S3_RTC_CLK_SRC_EXT_CRYS=y

#use UART0 as default console
ESP_CONSOLE_UART_DEFAULT=n

CONFIG_TINYUSB_DESC_CUSTOM_VID=0x303A
CONFIG_TINYUSB_DESC_CUSTOM_PID=0x8001
CONFIG_TINYUSB_DESC_BCD_DEVICE=0x0100
CONFIG_TINYUSB_DESC_USE_ESPRESSIF_VID=n
CONFIG_TINYUSB_DESC_USE_DEFAULT_PID=n
CONFIG_TINYUSB_DESC_MANUFACTURER_STRING="TITAN SPORTS"
CONFIG_TINYUSB_DESC_PRODUCT_STRING="TITAN"
CONFIG_TINYUSB_DESC_SERIAL_STRING="IBT3XXXXXX"


# NIMBLE
CONFIG_BT_NIMBLE_MAX_CONNECTIONS=8
CONFIG_BT_CTRL_MODEM_SLEEP=y
CONFIG_BT_CTRL_MODEM_SLEEP_MODE_1=y
CONFIG_BT_CTRL_LOW_POWER_CLOCK=BT_CTRL_LPCLK_SEL_EXT_32K_XTAL

# BLE issue regarding GIL lock and stack size, they suggested increasing stack size
# https://github.com/micropython/micropython/issues/12349
# here, we double them again
CONFIG_BT_NIMBLE_HOST_TASK_STACK_SIZE=8192
CONFIG_BT_NIMBLE_TASK_STACK_SIZE=12288

# Disable slow or unused EC curves
#CONFIG_MBEDTLS_ECP_DP_BP256R1_ENABLED=n
#CONFIG_MBEDTLS_ECP_DP_BP384R1_ENABLED=n
#CONFIG_MBEDTLS_ECP_DP_BP512R1_ENABLED=n
#CONFIG_MBEDTLS_ECP_DP_CURVE25519_ENABLED=n

